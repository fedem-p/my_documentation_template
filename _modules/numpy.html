<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <meta name="generator" content="sphinx-3.5.2, furo 2021.02.28.beta28"/>
        <title>numpy - </title>
      <link rel="stylesheet" href="../_static/styles/furo.css?digest=be5985a4059b5c2cd56ed0804790452beca62674">
    <link rel="stylesheet" href="../_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" href="../_static/styles/furo-extensions.css?digest=d391b54134226e4196576da3bdb6dddb7e05ba2b"></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand"></div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/LogoDotOrg_Black.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text"></span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro1.html">1. A Simple intro Chapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro2.html">2. A Simple intro Chapter 2</a></li>
</ul>
<p class="caption"><span class="caption-text">Core Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/main1.html">1. A Simple core Chapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/main2.html">2. A Simple core Chapter 2</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">1. API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/numpy.sum.html">1.1.1. numpy.sum</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/myproject.html">1.1.2. myproject</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/myproject.main.html">1.1.2.1. myproject.main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/myproject.module1.html">1.1.2.2. myproject.module1</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/myproject.html">1.1.2. myproject</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/myproject.main.html">1.1.2.1. myproject.main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/myproject.module1.html">1.1.2.2. myproject.module1</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <h1>Source code for numpy</h1><div class="highlight"><pre>
<span></span><span class="sd">"""</span>
<span class="sd">NumPy</span>
<span class="sd">=====</span>

<span class="sd">Provides</span>
<span class="sd">  1. An array object of arbitrary homogeneous items</span>
<span class="sd">  2. Fast mathematical operations over arrays</span>
<span class="sd">  3. Linear Algebra, Fourier Transforms, Random Number Generation</span>

<span class="sd">How to use the documentation</span>
<span class="sd">----------------------------</span>
<span class="sd">Documentation is available in two forms: docstrings provided</span>
<span class="sd">with the code, and a loose standing reference guide, available from</span>
<span class="sd">`the NumPy homepage &lt;https://www.scipy.org&gt;`_.</span>

<span class="sd">We recommend exploring the docstrings using</span>
<span class="sd">`IPython &lt;https://ipython.org&gt;`_, an advanced Python shell with</span>
<span class="sd">TAB-completion and introspection capabilities.  See below for further</span>
<span class="sd">instructions.</span>

<span class="sd">The docstring examples assume that `numpy` has been imported as `np`::</span>

<span class="sd">  &gt;&gt;&gt; import numpy as np</span>

<span class="sd">Code snippets are indicated by three greater-than signs::</span>

<span class="sd">  &gt;&gt;&gt; x = 42</span>
<span class="sd">  &gt;&gt;&gt; x = x + 1</span>

<span class="sd">Use the built-in ``help`` function to view a function's docstring::</span>

<span class="sd">  &gt;&gt;&gt; help(np.sort)</span>
<span class="sd">  ... # doctest: +SKIP</span>

<span class="sd">For some objects, ``np.info(obj)`` may provide additional help.  This is</span>
<span class="sd">particularly true if you see the line "Help on ufunc object:" at the top</span>
<span class="sd">of the help() page.  Ufuncs are implemented in C, not Python, for speed.</span>
<span class="sd">The native Python help() does not know how to view their help, but our</span>
<span class="sd">np.info() function does.</span>

<span class="sd">To search for documents containing a keyword, do::</span>

<span class="sd">  &gt;&gt;&gt; np.lookfor('keyword')</span>
<span class="sd">  ... # doctest: +SKIP</span>

<span class="sd">General-purpose documents like a glossary and help on the basic concepts</span>
<span class="sd">of numpy are available under the ``doc`` sub-module::</span>

<span class="sd">  &gt;&gt;&gt; from numpy import doc</span>
<span class="sd">  &gt;&gt;&gt; help(doc)</span>
<span class="sd">  ... # doctest: +SKIP</span>

<span class="sd">Available subpackages</span>
<span class="sd">---------------------</span>
<span class="sd">doc</span>
<span class="sd">    Topical documentation on broadcasting, indexing, etc.</span>
<span class="sd">lib</span>
<span class="sd">    Basic functions used by several sub-packages.</span>
<span class="sd">random</span>
<span class="sd">    Core Random Tools</span>
<span class="sd">linalg</span>
<span class="sd">    Core Linear Algebra Tools</span>
<span class="sd">fft</span>
<span class="sd">    Core FFT routines</span>
<span class="sd">polynomial</span>
<span class="sd">    Polynomial tools</span>
<span class="sd">testing</span>
<span class="sd">    NumPy testing tools</span>
<span class="sd">f2py</span>
<span class="sd">    Fortran to Python Interface Generator.</span>
<span class="sd">distutils</span>
<span class="sd">    Enhancements to distutils with support for</span>
<span class="sd">    Fortran compilers support and more.</span>

<span class="sd">Utilities</span>
<span class="sd">---------</span>
<span class="sd">test</span>
<span class="sd">    Run numpy unittests</span>
<span class="sd">show_config</span>
<span class="sd">    Show numpy build configuration</span>
<span class="sd">dual</span>
<span class="sd">    Overwrite certain functions with high-performance SciPy tools.</span>
<span class="sd">    Note: `numpy.dual` is deprecated.  Use the functions from NumPy or Scipy</span>
<span class="sd">    directly instead of importing them from `numpy.dual`.</span>
<span class="sd">matlib</span>
<span class="sd">    Make everything matrices.</span>
<span class="sd">__version__</span>
<span class="sd">    NumPy version string</span>

<span class="sd">Viewing documentation using IPython</span>
<span class="sd">-----------------------------------</span>
<span class="sd">Start IPython with the NumPy profile (``ipython -p numpy``), which will</span>
<span class="sd">import `numpy` under the alias `np`.  Then, use the ``cpaste`` command to</span>
<span class="sd">paste examples into the shell.  To see which functions are available in</span>
<span class="sd">`numpy`, type ``np.&lt;TAB&gt;`` (where ``&lt;TAB&gt;`` refers to the TAB key), or use</span>
<span class="sd">``np.*cos*?&lt;ENTER&gt;`` (where ``&lt;ENTER&gt;`` refers to the ENTER key) to narrow</span>
<span class="sd">down the list.  To view the docstring for a function, use</span>
<span class="sd">``np.cos?&lt;ENTER&gt;`` (to view the docstring) and ``np.cos??&lt;ENTER&gt;`` (to view</span>
<span class="sd">the source code).</span>

<span class="sd">Copies vs. in-place operation</span>
<span class="sd">-----------------------------</span>
<span class="sd">Most of the functions in `numpy` return a copy of the array argument</span>
<span class="sd">(e.g., `np.sort`).  In-place versions of these functions are often</span>
<span class="sd">available as array methods, i.e. ``x = np.array([1,2,3]); x.sort()``.</span>
<span class="sd">Exceptions to this rule are documented.</span>

<span class="sd">"""</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">._globals</span> <span class="kn">import</span> <span class="n">ModuleDeprecationWarning</span><span class="p">,</span> <span class="n">VisibleDeprecationWarning</span>
<span class="kn">from</span> <span class="nn">._globals</span> <span class="kn">import</span> <span class="n">_NoValue</span>

<span class="c1"># We first need to detect if we're being called as part of the numpy setup</span>
<span class="c1"># procedure itself in a reliable manner.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">__NUMPY_SETUP__</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">__NUMPY_SETUP__</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="n">__NUMPY_SETUP__</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'Running from numpy source directory.</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">numpy.__config__</span> <span class="kn">import</span> <span class="n">show</span> <span class="k">as</span> <span class="n">show_config</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"""Error importing numpy: you should not try to import numpy from</span>
<span class="s2">        its source directory; please exit the numpy source tree, and relaunch</span>
<span class="s2">        your python interpreter from there."""</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="kn">from</span> <span class="nn">.version</span> <span class="kn">import</span> <span class="n">git_revision</span> <span class="k">as</span> <span class="n">__git_revision__</span>
    <span class="kn">from</span> <span class="nn">.version</span> <span class="kn">import</span> <span class="n">version</span> <span class="k">as</span> <span class="n">__version__</span>

    <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ModuleDeprecationWarning'</span><span class="p">,</span>
               <span class="s1">'VisibleDeprecationWarning'</span><span class="p">]</span>

    <span class="c1"># mapping of {name: (value, deprecation_msg)}</span>
    <span class="n">__deprecated_attrs__</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Allow distributors to run custom init code</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_distributor_init</span>

    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">core</span>
    <span class="kn">from</span> <span class="nn">.core</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">compat</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">lib</span>
    <span class="c1"># NOTE: to be revisited following future namespace cleanup.</span>
    <span class="c1"># See gh-14454 and gh-15672 for discussion.</span>
    <span class="kn">from</span> <span class="nn">.lib</span> <span class="kn">import</span> <span class="o">*</span>

    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">linalg</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">fft</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">polynomial</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">random</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">ctypeslib</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">ma</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">matrixlib</span> <span class="k">as</span> <span class="n">_mat</span>
    <span class="kn">from</span> <span class="nn">.matrixlib</span> <span class="kn">import</span> <span class="o">*</span>

    <span class="c1"># Deprecations introduced in NumPy 1.20.0, 2020-06-06</span>
    <span class="kn">import</span> <span class="nn">builtins</span> <span class="k">as</span> <span class="nn">_builtins</span>

    <span class="n">_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"`np.</span><span class="si">{n}</span><span class="s2">` is a deprecated alias for the builtin `</span><span class="si">{n}</span><span class="s2">`. "</span>
        <span class="s2">"To silence this warning, use `</span><span class="si">{n}</span><span class="s2">` by itself. Doing this will not "</span>
        <span class="s2">"modify any behavior and is safe. </span><span class="si">{extended_msg}</span><span class="se">\n</span><span class="s2">"</span>
        <span class="s2">"Deprecated in NumPy 1.20; for more details and guidance: "</span>
        <span class="s2">"https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations"</span><span class="p">)</span>

    <span class="n">_specific_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"If you specifically wanted the numpy scalar type, use `np.</span><span class="si">{}</span><span class="s2">` here."</span><span class="p">)</span>

    <span class="n">_int_extended_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"When replacing `np.</span><span class="si">{}</span><span class="s2">`, you may wish to use e.g. `np.int64` "</span>
        <span class="s2">"or `np.int32` to specify the precision. If you wish to review "</span>
        <span class="s2">"your current use, check the release note link for "</span>
        <span class="s2">"additional information."</span><span class="p">)</span>

    <span class="n">_type_info</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),</span>  <span class="c1"># The NumPy scalar only exists by name.</span>
        <span class="p">(</span><span class="s2">"bool"</span><span class="p">,</span> <span class="n">_specific_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"bool_"</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">"float"</span><span class="p">,</span> <span class="n">_specific_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"float64"</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">"complex"</span><span class="p">,</span> <span class="n">_specific_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"complex128"</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">"str"</span><span class="p">,</span> <span class="n">_specific_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"str_"</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">"int"</span><span class="p">,</span> <span class="n">_int_extended_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"int"</span><span class="p">))]</span>

    <span class="n">__deprecated_attrs__</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="n">n</span><span class="p">:</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">_builtins</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">extended_msg</span><span class="o">=</span><span class="n">extended_msg</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">extended_msg</span> <span class="ow">in</span> <span class="n">_type_info</span>
    <span class="p">})</span>

    <span class="n">_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"`np.</span><span class="si">{n}</span><span class="s2">` is a deprecated alias for `np.compat.</span><span class="si">{n}</span><span class="s2">`. "</span>
        <span class="s2">"To silence this warning, use `np.compat.</span><span class="si">{n}</span><span class="s2">` by itself. "</span>
        <span class="s2">"In the likely event your code does not need to work on Python 2 "</span>
        <span class="s2">"you can use the builtin `</span><span class="si">{n2}</span><span class="s2">` for which `np.compat.</span><span class="si">{n}</span><span class="s2">` is itself "</span>
        <span class="s2">"an alias. Doing this will not modify any behaviour and is safe. "</span>
        <span class="s2">"</span><span class="si">{extended_msg}</span><span class="se">\n</span><span class="s2">"</span>
        <span class="s2">"Deprecated in NumPy 1.20; for more details and guidance: "</span>
        <span class="s2">"https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations"</span><span class="p">)</span>

    <span class="n">__deprecated_attrs__</span><span class="p">[</span><span class="s2">"long"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">compat</span><span class="p">,</span> <span class="s2">"long"</span><span class="p">),</span>
        <span class="n">_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s2">"long"</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="s2">"int"</span><span class="p">,</span>
                    <span class="n">extended_msg</span><span class="o">=</span><span class="n">_int_extended_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"long"</span><span class="p">)))</span>

    <span class="n">__deprecated_attrs__</span><span class="p">[</span><span class="s2">"unicode"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">compat</span><span class="p">,</span> <span class="s2">"unicode"</span><span class="p">),</span>
        <span class="n">_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s2">"unicode"</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="s2">"str"</span><span class="p">,</span>
                    <span class="n">extended_msg</span><span class="o">=</span><span class="n">_specific_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"str_"</span><span class="p">)))</span>

    <span class="k">del</span> <span class="n">_msg</span><span class="p">,</span> <span class="n">_specific_msg</span><span class="p">,</span> <span class="n">_int_extended_msg</span><span class="p">,</span> <span class="n">_type_info</span><span class="p">,</span> <span class="n">_builtins</span>

    <span class="kn">from</span> <span class="nn">.core</span> <span class="kn">import</span> <span class="nb">round</span><span class="p">,</span> <span class="nb">abs</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="nb">min</span>
    <span class="c1"># now that numpy modules are imported, can initialize limits</span>
    <span class="n">core</span><span class="o">.</span><span class="n">getlimits</span><span class="o">.</span><span class="n">_register_known_types</span><span class="p">()</span>

    <span class="n">__all__</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">'__version__'</span><span class="p">,</span> <span class="s1">'show_config'</span><span class="p">])</span>
    <span class="n">__all__</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">__all__</span><span class="p">)</span>
    <span class="n">__all__</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_mat</span><span class="o">.</span><span class="n">__all__</span><span class="p">)</span>
    <span class="n">__all__</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">__all__</span><span class="p">)</span>
    <span class="n">__all__</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">'linalg'</span><span class="p">,</span> <span class="s1">'fft'</span><span class="p">,</span> <span class="s1">'random'</span><span class="p">,</span> <span class="s1">'ctypeslib'</span><span class="p">,</span> <span class="s1">'ma'</span><span class="p">])</span>

    <span class="c1"># These are exported by np.core, but are replaced by the builtins below</span>
    <span class="c1"># remove them to ensure that we don't end up with `np.long == np.int_`,</span>
    <span class="c1"># which would be a breaking change.</span>
    <span class="k">del</span> <span class="n">long</span><span class="p">,</span> <span class="n">unicode</span>
    <span class="n">__all__</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">'long'</span><span class="p">)</span>
    <span class="n">__all__</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">'unicode'</span><span class="p">)</span>

    <span class="c1"># Remove things that are in the numpy.lib but not in the numpy namespace</span>
    <span class="c1"># Note that there is a test (numpy/tests/test_public_api.py:test_numpy_namespace)</span>
    <span class="c1"># that prevents adding more things to the main namespace by accident.</span>
    <span class="c1"># The list below will grow until the `from .lib import *` fixme above is</span>
    <span class="c1"># taken care of</span>
    <span class="n">__all__</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">'Arrayterator'</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">Arrayterator</span>

    <span class="c1"># These names were removed in NumPy 1.20.  For at least one release,</span>
    <span class="c1"># attempts to access these names in the numpy namespace will trigger</span>
    <span class="c1"># a warning, and calling the function will raise an exception.</span>
    <span class="n">_financial_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'fv'</span><span class="p">,</span> <span class="s1">'ipmt'</span><span class="p">,</span> <span class="s1">'irr'</span><span class="p">,</span> <span class="s1">'mirr'</span><span class="p">,</span> <span class="s1">'nper'</span><span class="p">,</span> <span class="s1">'npv'</span><span class="p">,</span> <span class="s1">'pmt'</span><span class="p">,</span>
                        <span class="s1">'ppmt'</span><span class="p">,</span> <span class="s1">'pv'</span><span class="p">,</span> <span class="s1">'rate'</span><span class="p">]</span>
    <span class="n">__expired_functions__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="sa">f</span><span class="s1">'In accordance with NEP 32, the function </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> was removed '</span>
               <span class="s1">'from NumPy version 1.20.  A replacement for this function '</span>
               <span class="s1">'is available in the numpy_financial library: '</span>
               <span class="s1">'https://pypi.org/project/numpy-financial'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">_financial_names</span><span class="p">}</span>

    <span class="c1"># Filter out Cython harmless warnings</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.dtype size changed"</span><span class="p">)</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.ufunc size changed"</span><span class="p">)</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.ndarray size changed"</span><span class="p">)</span>

    <span class="c1"># oldnumeric and numarray were removed in 1.9. In case some packages import</span>
    <span class="c1"># but do not use them, we define them here for backward compatibility.</span>
    <span class="n">oldnumeric</span> <span class="o">=</span> <span class="s1">'removed'</span>
    <span class="n">numarray</span> <span class="o">=</span> <span class="s1">'removed'</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
        <span class="c1"># module level getattr is only supported in 3.7 onwards</span>
        <span class="c1"># https://www.python.org/dev/peps/pep-0562/</span>
        <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>
            <span class="c1"># Warn for expired attributes, and return a dummy function</span>
            <span class="c1"># that always raises an exception.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">__expired_functions__</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">def</span> <span class="nf">_expired</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">_expired</span>

            <span class="c1"># Emit warnings for deprecated attributes</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">__deprecated_attrs__</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">val</span>

            <span class="c1"># Importing Tester requires importing all of UnitTest which is not a</span>
            <span class="c1"># cheap import Since it is mainly used in test suits, we lazy import it</span>
            <span class="c1"># here to save on the order of 10 ms of import time for most users</span>
            <span class="c1">#</span>
            <span class="c1"># The previous way Tester was imported also had a side effect of adding</span>
            <span class="c1"># the full `numpy.testing` namespace</span>
            <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">'testing'</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">numpy.testing</span> <span class="k">as</span> <span class="nn">testing</span>
                <span class="k">return</span> <span class="n">testing</span>
            <span class="k">elif</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">'Tester'</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">.testing</span> <span class="kn">import</span> <span class="n">Tester</span>
                <span class="k">return</span> <span class="n">Tester</span>

            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">"module </span><span class="si">{!r}</span><span class="s2"> has no attribute "</span>
                                 <span class="s2">"</span><span class="si">{!r}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

        <span class="k">def</span> <span class="fm">__dir__</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">|</span> <span class="p">{</span><span class="s1">'Tester'</span><span class="p">,</span> <span class="s1">'testing'</span><span class="p">})</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We don't actually use this ourselves anymore, but I'm not 100% sure that</span>
        <span class="c1"># no-one else in the world is using it (though I hope not)</span>
        <span class="kn">from</span> <span class="nn">.testing</span> <span class="kn">import</span> <span class="n">Tester</span>

        <span class="c1"># We weren't able to emit a warning about these, so keep them around</span>
        <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span> <span class="ow">in</span> <span class="n">__deprecated_attrs__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">})</span>


    <span class="c1"># Pytest testing</span>
    <span class="kn">from</span> <span class="nn">numpy._pytesttester</span> <span class="kn">import</span> <span class="n">PytestTester</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">PytestTester</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">PytestTester</span>


    <span class="k">def</span> <span class="nf">_sanity_check</span><span class="p">():</span>
        <span class="sd">"""</span>
<span class="sd">        Quick sanity checks for common bugs caused by environment.</span>
<span class="sd">        There are some cases e.g. with wrong BLAS ABI that cause wrong</span>
<span class="sd">        results under specific runtime conditions that are not necessarily</span>
<span class="sd">        achieved during test suite runs, and it is useful to catch those early.</span>

<span class="sd">        See https://github.com/numpy/numpy/issues/8577 and other</span>
<span class="sd">        similar bug reports.</span>

<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"The current Numpy installation (</span><span class="si">{!r}</span><span class="s2">) fails to "</span>
                   <span class="s2">"pass simple sanity checks. This can be caused for example "</span>
                   <span class="s2">"by incorrect BLAS library being linked in, or by mixing "</span>
                   <span class="s2">"package managers (pip, conda, apt, ...). Search closed "</span>
                   <span class="s2">"numpy issues for similar problems."</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="kn">from</span> <span class="bp">None</span>

    <span class="n">_sanity_check</span><span class="p">()</span>
    <span class="k">del</span> <span class="n">_sanity_check</span>

    <span class="k">def</span> <span class="nf">_mac_os_check</span><span class="p">():</span>
        <span class="sd">"""</span>
<span class="sd">        Quick Sanity check for Mac OS look for accelerate build bugs.</span>
<span class="sd">        Testing numpy polyfit calls init_dgelsd(LAPACK)</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">polyval</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">"darwin"</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
            <span class="n">_mac_os_check</span><span class="p">()</span>
            <span class="c1"># Throw runtime error, if the test failed Check for warning and error_message</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">""</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">error_message</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="p">))</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">"Polyfit sanity test emitted a warning, most likely due "</span>
                    <span class="s2">"to using a buggy Accelerate backend. If you compiled "</span>
                    <span class="s2">"yourself, more information is available at "</span>
                    <span class="s2">"https://numpy.org/doc/stable/user/building.html#accelerated-blas-lapack-libraries "</span>
                    <span class="s2">"Otherwise report this to the vendor "</span>
                    <span class="s2">"that provided NumPy.</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error_message</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">_mac_os_check</span>

    <span class="c1"># We usually use madvise hugepages support, but on some old kernels it</span>
    <span class="c1"># is slow and thus better avoided.</span>
    <span class="c1"># Specifically kernel version 4.6 had a bug fix which probably fixed this:</span>
    <span class="c1"># https://github.com/torvalds/linux/commit/7cf91a98e607c2f935dbcc177d70011e95b8faff</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="n">use_hugepage</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"NUMPY_MADVISE_HUGEPAGE"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">"linux"</span> <span class="ow">and</span> <span class="n">use_hugepage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If there is an issue with parsing the kernel version,</span>
        <span class="c1"># set use_hugepages to 0. Usage of LooseVersion will handle</span>
        <span class="c1"># the kernel version parsing better, but avoided since it</span>
        <span class="c1"># will increase the import time. See: #16679 for related discussion.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">use_hugepage</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">kernel_version</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">uname</span><span class="p">()</span><span class="o">.</span><span class="n">release</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"."</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">kernel_version</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kernel_version</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">kernel_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
                <span class="n">use_hugepage</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">use_hugepages</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">use_hugepage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># This is not Linux, so it should not matter, just enable anyway</span>
        <span class="n">use_hugepage</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">use_hugepage</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">use_hugepage</span><span class="p">)</span>

    <span class="c1"># Note that this will currently only make a difference on Linux</span>
    <span class="n">core</span><span class="o">.</span><span class="n">multiarray</span><span class="o">.</span><span class="n">_set_madvise_hugepage</span><span class="p">(</span><span class="n">use_hugepage</span><span class="p">)</span>
</pre></div>
      </article>
      <footer>
        
        <div class="related-pages">
          
          
        </div>

        <div class="related-information">
              Copyright &#169; 2020
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </main>
</div>
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="../_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></body>
</html>